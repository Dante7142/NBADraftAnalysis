knitr::opts_chunk$set(echo = TRUE)
# Compute difference between actual and expected
FinalDraftData <- FinalDraftData %>%
mutate(PerformanceLift = FinalScore - ExpectedScore)
# Compute difference between actual and expected
FinalDraftData <- FinalDraftData %>%
mutate(PerformanceLift = FinalScore - ExpectedScore)
# Compute difference between actual and expected
library(dplyr)
FinalDraftData <- FinalDraftData %>%
mutate(PerformanceLift = FinalScore - ExpectedScore)
# Top 10 overperformers and underperformers
top_over <- FinalDraftData %>%
arrange(desc(PerformanceLift)) %>%
slice_head(n = 10)
top_under <- FinalDraftData %>%
arrange(PerformanceLift) %>%
slice_head(n = 10)
# Combine
top_combined <- bind_rows(top_over, top_under) %>%
mutate(
Player = reorder(Player, PerformanceLift),
Label = ifelse(PerformanceLift > 0, "Overperformer", "Underperformer")
)
# Plot
ggplot(top_combined, aes(x = Player, y = PerformanceLift, fill = Label)) +
geom_col() +
coord_flip() +
scale_fill_manual(values = c("Underperformer" = "tomato", "Overperformer" = "steelblue")) +
labs(
title = "Top 10 Overperformers and Underperformers vs. Expectations",
x = NULL,
y = "FinalScore − ExpectedScore",
fill = NULL
) +
theme_minimal(base_size = 12)
library(dplyr)
library(stringi)
library(hoopR)
library(ggplot2)
library(dplyr)
library(stringi)
library(hoopR)
library(ggplot2)
# Compute difference between actual and expected
library(dplyr)
FinalDraftData <- FinalDraftData %>%
mutate(PerformanceLift = FinalScore - ExpectedScore)
# Top 10 overperformers and underperformers
top_over <- FinalDraftData %>%
arrange(desc(PerformanceLift)) %>%
slice_head(n = 10)
top_under <- FinalDraftData %>%
arrange(PerformanceLift) %>%
slice_head(n = 10)
# Combine
top_combined <- bind_rows(top_over, top_under) %>%
mutate(
Player = reorder(Player, PerformanceLift),
Label = ifelse(PerformanceLift > 0, "Overperformer", "Underperformer")
)
# Plot
ggplot(top_combined, aes(x = Player, y = PerformanceLift, fill = Label)) +
geom_col() +
coord_flip() +
scale_fill_manual(values = c("Underperformer" = "tomato", "Overperformer" = "steelblue")) +
labs(
title = "Top 10 Overperformers and Underperformers vs. Expectations",
x = NULL,
y = "FinalScore − ExpectedScore",
fill = NULL
) +
theme_minimal(base_size = 12)
# Compute difference between actual and expected
FinalDraftData <- FinalDraftData %>%
mutate(PerformanceLift = FinalScore - ExpectedScore)
# Top 10 overperformers and underperformers
top_over <- FinalDraftData %>%
arrange(desc(PerformanceLift)) %>%
slice_head(n = 10)
top_under <- FinalDraftData %>%
arrange(PerformanceLift) %>%
slice_head(n = 10)
# Combine them and order by performance difference
top_combined <- bind_rows(top_over, top_under) %>%
mutate(
Player = reorder(Player, PerformanceLift),
Label = ifelse(PerformanceLift > 0, "Overperformer", "Underperformer")
)
# Plot
ggplot(top_combined, aes(x = Player, y = PerformanceLift, fill = Label)) +
geom_col(show.legend = FALSE) +
coord_flip() +
geom_text(
aes(label = round(PerformanceLift, 2)),
hjust = ifelse(top_combined$PerformanceLift > 0, -0.2, 1.1),
color = "black",
size = 3.5
) +
scale_fill_manual(values = c("Overperformer" = "#1f77b4", "Underperformer" = "#d62728")) +
labs(
title = "Top 10 Overperformers and Underperformers Relative to Draft Expectation",
x = NULL,
y = "FinalScore − ExpectedScore"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
axis.text.y = element_text(size = 10)
) +
expand_limits(y = c(min(top_combined$PerformanceLift) * 1.2,
max(top_combined$PerformanceLift) * 1.2))
compare_players <- FinalDraftData %>%
filter(Player %in% c("Nikola Jokic", "Nikola Vucevic")) %>%
select(Player, Pick, PerformanceScore, ExpectedScore, FinalScore)
# Convert to long format for easy plotting
compare_long <- compare_players %>%
tidyr::pivot_longer(cols = c(PerformanceScore, ExpectedScore, FinalScore),
names_to = "Metric",
values_to = "Score")
# Plot
ggplot(compare_long, aes(x = Metric, y = Score, fill = Player)) +
geom_col(position = "dodge") +
geom_text(aes(label = round(Score, 2)),
position = position_dodge(width = 0.9),
vjust = -0.3, size = 3.8) +
labs(
title = "Player Comparison: Nikola Vučević vs. Nikola Jokić",
subtitle = "PerformanceScore, ExpectedScore, and FinalScore",
x = NULL, y = "Score"
) +
scale_fill_manual(values = c("Nikola Jokic" = "#1f77b4", "Nikola Vucevic" = "#ff7f0e")) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)
)
(59.11922+66.26811+65.16260+57.21224+74.58946+73.88954+60.31843+57.83079+61.69720+58.08482+71.48091+68.49734+61.61538+56.25029+86.91115+50.31367+71.41073+81.04413)/18
(100.14125-63.84974)/sd(84.10769, 49.12930, 32.70911, 65.10349, 68.83656, 100.14125, 63.93075)
my_vector <- c(84.10769, 49.12930, 32.70911, 65.10349, 68.83656, 100.14125, 63.93075))
my_vector <- c(84.10769, 49.12930, 32.70911, 65.10349, 68.83656, 100.14125, 63.93075)
(100.14125-63.84974)/sd(my_vector)
my_vector <- c(84.10769, 49.12930, 32.70911, 65.10349, 68.83656, 100.14125, 63.93075, 46.83979)
(100.14125-63.84974)/sd(my_vector)
FinalDraftData <- FinalDraftData %>%
group_by(Pick) %>%
mutate(
FinalScore = (PerformanceScore - mean(PerformanceScore, na.rm = TRUE))
) %>%
ungroup()
leaderboards <- FinalDraftData %>%
filter(!is.na(Position), !is.na(FinalScore)) %>%
group_by(Position) %>%
arrange(desc(FinalScore), .by_group = TRUE) %>%
mutate(PosRank = row_number()) %>%
ungroup()
View(NBADraftData)
FinalDraftData$Position[73] <- "C"
FinalDraftData$Position[48] <- "G"
FinalDraftData$Position[720] <- "C"
FinalDraftData$Position[73] <- "F"
FinalDraftData$Position[48] <- "G"
FinalDraftData$Position[720] <- "C"
FinalDraftData <- FinalDraftData %>%
group_by(Pick) %>%
mutate(
FinalScore = (PerformanceScore - mean(PerformanceScore, na.rm = TRUE))
) %>%
ungroup()
leaderboards <- FinalDraftData %>%
filter(!is.na(Position), !is.na(FinalScore)) %>%
group_by(Position) %>%
arrange(desc(FinalScore), .by_group = TRUE) %>%
mutate(PosRank = row_number()) %>%
ungroup()
leaderboards <- subset(leaderboards, select = c(Player, Pick, Position, PosRank, FinalScore))
library(ggplot2)
library(dplyr)
library(ggrepel)  # install.packages("ggrepel") if not installed
install.packages("ggrepel")
library(ggplot2)
library(dplyr)
library(ggrepel)  # install.packages("ggrepel") if not installed
# Filter for lottery picks
lottery_data <- FinalDraftData %>%
filter(Pick <= 15)
# Calculate average, best, and worst per pick
pick_summary <- lottery_data %>%
group_by(Pick) %>%
summarise(
AvgPerformance = mean(PerformanceScore, na.rm = TRUE),
BestPlayer = Player[which.max(PerformanceScore)],
BestScore = max(PerformanceScore, na.rm = TRUE),
WorstPlayer = Player[which.min(PerformanceScore)],
WorstScore = min(PerformanceScore, na.rm = TRUE)
)
# Base scatterplot of all players (gray background)
ggplot(lottery_data, aes(x = Pick, y = PerformanceScore)) +
geom_jitter(width = 0.3, alpha = 0.4, color = "gray50") +
# Trend line (average performance)
geom_line(data = pick_summary, aes(x = Pick, y = AvgPerformance),
color = "blue", size = 1.2) +
geom_point(data = pick_summary, aes(x = Pick, y = AvgPerformance),
color = "blue", size = 2.5) +
# Best players (green points + labels)
geom_point(data = pick_summary, aes(x = Pick, y = BestScore),
color = "darkgreen", size = 3) +
geom_text_repel(
data = pick_summary,
aes(x = Pick, y = BestScore, label = BestPlayer),
color = "darkgreen", size = 3, nudge_y = 2
) +
# Worst players (red points + labels)
geom_point(data = pick_summary, aes(x = Pick, y = WorstScore),
color = "red", size = 3) +
geom_text_repel(
data = pick_summary,
aes(x = Pick, y = WorstScore, label = WorstPlayer),
color = "red", size = 3, nudge_y = -2
) +
scale_x_continuous(breaks = 1:15) +
labs(
title = "Lottery Picks (1–15): Performance Trends and Extremes",
subtitle = "Blue = Average | Green = Best Player | Red = Worst Player",
x = "Draft Pick",
y = "Performance Score"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)
)
leaderboards <- subset(leaderboards, select = c(Player, Pick, Position, PosRank, FinalScore, Team))
leaderboards <- FinalDraftData %>%
filter(!is.na(Position), !is.na(FinalScore)) %>%
group_by(Position) %>%
arrange(desc(FinalScore), .by_group = TRUE) %>%
mutate(PosRank = row_number()) %>%
ungroup()
leaderboards <- subset(leaderboards, select = c(Player, Pick, Position, PosRank, FinalScore, Team))
library(dplyr)
team_summary <- leaderboards %>%
group_by(Team) %>%
summarise(
AvgFinalScore = mean(FinalScore, na.rm = TRUE),
MedianFinalScore = median(FinalScore, na.rm = TRUE),
Count = n()
) %>%
arrange(desc(AvgFinalScore))
View(team_summary)
leaderboards$Team[256] <- "WAS"
leaderboards$Team[67] <- "CHA"
leaderboards$Team[117] <- "CHA"
leaderboards$Team[227] <- "CHA"
leaderboards$Team[274] <- "CHA"
leaderboards$Team[342] <- "CHA"
leaderboards$Team[484] <- "CHA"
leaderboards$Team[634] <- "CHA"
leaderboards$Team[680] <- "CHA"
leaderboards$Team[214] <- "CHA"
leaderboards$Team[368] <- "CHA"
leaderboards$Team[437] <- "CHA"
leaderboards$Team[665] <- "CHA"
leaderboards$Team[318] <- "CHA"
leaderboards$Team[39] <- "MEM"
leaderboards$Team[223] <- "MEM"
leaderboards$Team[441] <- "MEM"
leaderboards$Team[443] <- "MEM"
leaderboards$Team[540] <- "MEM"
leaderboards$Team[575] <- "MEM"
leaderboards$Team[683] <- "MEM"
leaderboards$Team[754] <- "MEM"
library(dplyr)
team_summary <- leaderboards %>%
group_by(Team) %>%
summarise(
AvgFinalScore = mean(FinalScore, na.rm = TRUE),
MedianFinalScore = median(FinalScore, na.rm = TRUE),
Count = n()
) %>%
arrange(desc(AvgFinalScore))
leaderboards$Team[256] <- "WAS"
leaderboards$Team[67] <- "CHA"
leaderboards$Team[117] <- "CHA"
leaderboards$Team[227] <- "CHA"
leaderboards$Team[274] <- "CHA"
leaderboards$Team[342] <- "CHA"
leaderboards$Team[484] <- "CHA"
leaderboards$Team[634] <- "CHA"
leaderboards$Team[680] <- "CHA"
leaderboards$Team[214] <- "CHA"
leaderboards$Team[368] <- "CHA"
leaderboards$Team[437] <- "CHA"
leaderboards$Team[665] <- "CHA"
leaderboards$Team[318] <- "CHA"
leaderboards$Team[39] <- "MEM"
leaderboards$Team[223] <- "MEM"
leaderboards$Team[441] <- "MEM"
leaderboards$Team[443] <- "MEM"
leaderboards$Team[540] <- "MEM"
leaderboards$Team[575] <- "MEM"
leaderboards$Team[683] <- "MEM"
leaderboards$Team[754] <- "MEM"
leaderboards$Team[317] <- "MEM"
library(dplyr)
team_summary <- leaderboards %>%
group_by(Team) %>%
summarise(
AvgFinalScore = mean(FinalScore, na.rm = TRUE),
MedianFinalScore = median(FinalScore, na.rm = TRUE),
Count = n()
) %>%
arrange(desc(AvgFinalScore))
leaderboards$Team[256] <- "WAS"
leaderboards$Team[67] <- "CHA"
leaderboards$Team[117] <- "CHA"
leaderboards$Team[227] <- "CHA"
leaderboards$Team[274] <- "CHA"
leaderboards$Team[342] <- "CHA"
leaderboards$Team[484] <- "CHA"
leaderboards$Team[634] <- "CHA"
leaderboards$Team[680] <- "CHA"
leaderboards$Team[214] <- "CHA"
leaderboards$Team[368] <- "CHA"
leaderboards$Team[437] <- "CHA"
leaderboards$Team[665] <- "CHA"
leaderboards$Team[318] <- "CHA"
leaderboards$Team[39] <- "MEM"
leaderboards$Team[223] <- "MEM"
leaderboards$Team[441] <- "MEM"
leaderboards$Team[443] <- "MEM"
leaderboards$Team[540] <- "MEM"
leaderboards$Team[575] <- "MEM"
leaderboards$Team[683] <- "MEM"
leaderboards$Team[754] <- "MEM"
leaderboards$Team[317] <- "MEM"
leaderboards$Team[427] <- "NOH"
leaderboards$Team[440] <- "NOH"
library(dplyr)
team_summary <- leaderboards %>%
group_by(Team) %>%
summarise(
AvgFinalScore = mean(FinalScore, na.rm = TRUE),
MedianFinalScore = median(FinalScore, na.rm = TRUE),
Count = n()
) %>%
arrange(desc(AvgFinalScore))
leaderboards$Team[256] <- "WAS"
leaderboards$Team[67] <- "CHA"
leaderboards$Team[117] <- "CHA"
leaderboards$Team[227] <- "CHA"
leaderboards$Team[274] <- "CHA"
leaderboards$Team[342] <- "CHA"
leaderboards$Team[484] <- "CHA"
leaderboards$Team[634] <- "CHA"
leaderboards$Team[680] <- "CHA"
leaderboards$Team[214] <- "CHA"
leaderboards$Team[368] <- "CHA"
leaderboards$Team[437] <- "CHA"
leaderboards$Team[665] <- "CHA"
leaderboards$Team[318] <- "CHA"
leaderboards$Team[39] <- "MEM"
leaderboards$Team[223] <- "MEM"
leaderboards$Team[441] <- "MEM"
leaderboards$Team[443] <- "MEM"
leaderboards$Team[540] <- "MEM"
leaderboards$Team[575] <- "MEM"
leaderboards$Team[683] <- "MEM"
leaderboards$Team[754] <- "MEM"
leaderboards$Team[317] <- "MEM"
leaderboards$Team[427] <- "NOH"
leaderboards$Team[440] <- "NOH"
leaderboards$Team[27] <- "NJN"
leaderboards$Team[388] <- "NJN"
leaderboards$Team[690] <- "NJN"
library(dplyr)
team_summary <- leaderboards %>%
group_by(Team) %>%
summarise(
AvgFinalScore = mean(FinalScore, na.rm = TRUE),
MedianFinalScore = median(FinalScore, na.rm = TRUE),
Count = n()
) %>%
arrange(desc(AvgFinalScore))
leaderboards$Team[256] <- "WAS"
leaderboards$Team[67] <- "CHA"
leaderboards$Team[117] <- "CHA"
leaderboards$Team[227] <- "CHA"
leaderboards$Team[274] <- "CHA"
leaderboards$Team[342] <- "CHA"
leaderboards$Team[484] <- "CHA"
leaderboards$Team[634] <- "CHA"
leaderboards$Team[680] <- "CHA"
leaderboards$Team[214] <- "CHA"
leaderboards$Team[368] <- "CHA"
leaderboards$Team[437] <- "CHA"
leaderboards$Team[665] <- "CHA"
leaderboards$Team[318] <- "CHA"
leaderboards$Team[39] <- "MEM"
leaderboards$Team[223] <- "MEM"
leaderboards$Team[441] <- "MEM"
leaderboards$Team[443] <- "MEM"
leaderboards$Team[540] <- "MEM"
leaderboards$Team[575] <- "MEM"
leaderboards$Team[683] <- "MEM"
leaderboards$Team[754] <- "MEM"
leaderboards$Team[317] <- "MEM"
leaderboards$Team[427] <- "NOH"
leaderboards$Team[440] <- "NOH"
leaderboards$Team[27] <- "NJN"
leaderboards$Team[388] <- "NJN"
leaderboards$Team[690] <- "NJN"
leaderboards$Team[29] <- "OKC"
leaderboards$Team[68] <- "OKC"
leaderboards$Team[125] <- "OKC"
leaderboards$Team[150] <- "OKC"
leaderboards$Team[158] <- "OKC"
leaderboards$Team[174] <- "OKC"
leaderboards$Team[198] <- "OKC"
leaderboards$Team[221] <- "OKC"
leaderboards$Team[261] <- "OKC"
leaderboards$Team[262] <- "OKC"
leaderboards$Team[278] <- "OKC"
leaderboards$Team[298] <- "OKC"
leaderboards$Team[359] <- "OKC"
leaderboards$Team[499] <- "OKC"
leaderboards$Team[581] <- "OKC"
leaderboards$Team[588] <- "OKC"
leaderboards$Team[612] <- "OKC"
leaderboards$Team[677] <- "OKC"
leaderboards$Team[681] <- "OKC"
leaderboards$Team[786] <- "OKC"
library(dplyr)
team_summary <- leaderboards %>%
group_by(Team) %>%
summarise(
AvgFinalScore = mean(FinalScore, na.rm = TRUE),
MedianFinalScore = median(FinalScore, na.rm = TRUE),
Count = n()
) %>%
arrange(desc(AvgFinalScore))
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
library(glmnet)
knitr::opts_chunk$set(echo = TRUE)
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
library(glmnet)
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
knitr::opts_chunk$set(echo = TRUE)
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
library(glmnet)
library(dplyr)
FinalDraftData <- FinalDraftData %>%
filter(!is.na(VORP)) %>%
mutate(Position = factor(Position))
get_position_weights <- function(data, position_name) {
position_data <- data %>% filter(Position == position_name)
# Select predictor columns
features <- position_data %>%
select(PTS, REB, AST, STL, BLK, TOV, FGPercent, FTPercent, ThreePointPercent)
# Standardize features
x <- scale(as.matrix(features))
y <- position_data$VORP
# Fit ridge regression
cvfit <- cv.glmnet(x, y, alpha = 0)  # alpha=0 -> ridge
model <- glmnet(x, y, alpha = 0, lambda = cvfit$lambda.min)
# Extract coefficients
weights <- as.numeric(coef(model))[-1]  # drop intercept
names(weights) <- colnames(features)
# Normalize so weights sum to 1 (for interpretability)
weights_norm <- weights / sum(abs(weights))
tibble(Position = position_name,
Stat = names(weights_norm),
Weight = weights_norm)
}
weights_guard   <- get_position_weights(FinalDraftData, "G")
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
library(glmnet)
library(dplyr)
FinalDraftData <- FinalDraftData %>%
filter(!is.na(VORP)) %>%
mutate(Position = factor(Position))
get_position_weights <- function(data, position_name) {
position_data <- data %>% filter(Position == position_name)
# Select predictor columns
features <- position_data %>%
select(PTS, TRB, AST, STL, BLK, TOV, FGPercent, FreeThrowPercent, ThreePointPercent)
# Standardize features
x <- scale(as.matrix(features))
y <- position_data$VORP
# Fit ridge regression
cvfit <- cv.glmnet(x, y, alpha = 0)  # alpha=0 -> ridge
model <- glmnet(x, y, alpha = 0, lambda = cvfit$lambda.min)
# Extract coefficients
weights <- as.numeric(coef(model))[-1]  # drop intercept
names(weights) <- colnames(features)
# Normalize so weights sum to 1 (for interpretability)
weights_norm <- weights / sum(abs(weights))
tibble(Position = position_name,
Stat = names(weights_norm),
Weight = weights_norm)
}
weights_guard   <- get_position_weights(FinalDraftData, "G")
weights_forward <- get_position_weights(FinalDraftData, "F")
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
library(glmnet)
library(dplyr)
FinalDraftData <- FinalDraftData %>%
FinalDraftData[is.na(FinalDraftData)] <- 0 %>%
mutate(Position = factor(Position))
install.packages(c("glmnet", "dplyr", "tidyr", "scales"))
